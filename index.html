<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İstanbul Gayrimenkul Değerleme Dashboard | TÜİK Analizi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        #map { height: 500px; border-radius: 12px; }
        .stat-card { @apply bg-white p-6 rounded-xl shadow-sm border border-gray-100; }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">

    <div class="min-h-screen flex">
        <main class="flex-1 p-8">
            <header class="flex justify-between items-center mb-8">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900">İstanbul Emlak Analiz Paneli</h1>
                    <p class="text-sm text-gray-500">TÜİK Veri Entegrasyonu: 2021-2026 Projeksiyonu</p>
                </div>
                <div class="flex space-x-2">
                    <span class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium">İstanbul Geneli</span>
                </div>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="stat-card">
                    <h3 class="text-gray-400 text-xs font-bold uppercase">Bu Ay Toplam Satış</h3>
                    <p class="text-2xl font-bold text-blue-600">28.450</p>
                    <span class="text-green-500 text-xs">↑ %4.2 (Geçen aya göre)</span>
                </div>
                <div class="stat-card">
                    <h3 class="text-gray-400 text-xs font-bold uppercase">Yıllık Ortalama Değişim</h3>
                    <p class="text-2xl font-bold text-orange-600">%112.4</p>
                    <span class="text-gray-400 text-xs">TÜİK Konut Fiyat Endeksi</span>
                </div>
                <div class="stat-card">
                    <h3 class="text-gray-400 text-xs font-bold uppercase">İnşaat Maliyet Artışı</h3>
                    <p class="text-2xl font-bold text-red-600">%68.2</p>
                    <span class="text-sm text-gray-500">Son 6 Aylık Trend</span>
                </div>
                <div class="stat-card">
                    <h3 class="text-gray-400 text-xs font-bold uppercase">Stok Tahmini</h3>
                    <p class="text-2xl font-bold text-gray-800">12.100</p>
                    <span class="text-sm text-gray-500">Yeni Yapı İzinleri</span>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                    <h3 class="text-lg font-bold mb-4 italic text-blue-800">İlçe Bazlı Değerleme Haritası (Heatmap)</h3>
                    <div id="map"></div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                    <h3 class="text-lg font-bold mb-4">Satış Trendi (5 Yıl - 1 Yıl - 6 Ay)</h3>
                    <canvas id="trendChart"></canvas>
                    <div class="mt-4 flex justify-center space-x-4">
                        <button onclick="updateChart('5y')" class="text-xs px-3 py-1 bg-gray-200 rounded">5 Yıl</button>
                        <button onclick="updateChart('1y')" class="text-xs px-3 py-1 bg-gray-200 rounded">1 Yıl</button>
                        <button onclick="updateChart('6m')" class="text-xs px-3 py-1 bg-gray-200 rounded">6 Ay</button>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <h3 class="text-lg font-bold mb-4 text-emerald-800">Maliyet vs Satış Fiyatı Korelasyonu (TÜİK İlişkilendirme)</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-gray-50 text-gray-600">
                            <tr>
                                <th class="p-4">Dönem</th>
                                <th class="p-4">Konut Satış Adedi</th>
                                <th class="p-4">İnşaat Maliyet Endeksi</th>
                                <th class="p-4">Metrekare Birim Fiyat (Ort)</th>
                                <th class="p-4">Değişim (%)</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Harita Başlatma (İstanbul Koordinatları)
        const map = L.map('map').setView([41.0082, 28.9784], 10);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        // Örnek İlçe Verisi (Esenyurt, Kadıköy, Beşiktaş gibi noktalar)
        const districts = [
            { name: "Esenyurt", lat: 41.0343, lng: 28.6801, sales: 2500 },
            { name: "Kadıköy", lat: 40.9910, lng: 29.0270, sales: 1200 },
            { name: "Beşiktaş", lat: 41.0428, lng: 29.0075, sales: 850 }
        ];

        districts.forEach(d => {
            L.circle([d.lat, d.lng], {
                color: 'red', fillOpacity: 0.5, radius: d.sales * 2
            }).bindPopup(`${d.name}: ${d.sales} Satış (Bu Ay)`).addTo(map);
        });

        // Grafik Mantığı
        const ctx = document.getElementById('trendChart').getContext('2d');
        let trendChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['2021', '2022', '2023', '2024', '2025', '2026'],
                datasets: [{
                    label: 'İstanbul Konut Satışları',
                    data: [180000, 210000, 195000, 205000, 220000, 235000],
                    borderColor: '#2563eb',
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(37, 99, 235, 0.1)'
                }]
            }
        });

        function updateChart(period) {
            // Burada TÜİK verilerine göre data update edilecek
            alert(period + " verileri için TÜİK CSV/API bağlantısı bekleniyor.");
        }

        // Tablo Verisi (Örnek)
        const tableData = [
            { period: "Aralık 2025", sales: "24.120", cost: "1120.5", price: "45.000 TL", change: "+%2.1" },
            { period: "Kasım 2025", sales: "22.400", cost: "1105.2", price: "44.100 TL", change: "+%1.8" }
        ];

        const tableBody = document.getElementById('tableBody');
        tableData.forEach(row => {
            tableBody.innerHTML += `
                <tr class="border-t border-gray-50 hover:bg-gray-50">
                    <td class="p-4 font-medium">${row.period}</td>
                    <td class="p-4">${row.sales}</td>
                    <td class="p-4">${row.cost}</td>
                    <td class="p-4 font-bold text-blue-700">${row.price}</td>
                    <td class="p-4 text-green-600">${row.change}</td>
                </tr>
            `;
        });
    </script>
</body>
</html>
